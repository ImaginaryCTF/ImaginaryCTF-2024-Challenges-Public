import solvelinmod

mod=2**64
res=[924303399913049,2830611888841555553,11417572481992307149,9399377228148865497,4466300653933784009,6929356405062948441,1060599744128290109,2413293955258720417,12532996834583759385,924446205882046577,953636631316484173,8178891442779449225,5149328285628553929,14848938488663696553,10695623300750768253,331402136485900945,7526029785593005913,528067901588867841,17934877594923492173,1823014476946146745,4474927539439552841,11848375034122087289,14775913573091536445,6221187839989261569,8706220284657781273,12220531501790844433,6881877824236885709,1709544903114568809,13840396538186662729,1672874960389122761,12890717860805876349,12512590028788979697,17022931942054141529,4432258044383820193,17829278568412944077,15934592270780519321,9284508610800604361,8084337873092305561,9905442585384757565,9968445791360002913,2334598992640348185,11395810839179523505,16674150723980103501,1359876212648330057]

flag = [var('flag_%d' % i) for i in range(43)]
equations=[]
for x,r in zip(range(2,46),res):
    eq=0
    for i,c in enumerate(flag[::-1]):
        eq+=c * int(pow(x,i,mod))
    equations.append((eq == r,mod))
    print(f"entered f({x}) = {r}")

bounds = {flag[i]:2**8 for i in range(43)}

sol = solvelinmod.solve_linear_mod(equations, bounds)

out = []
for i in flag:
  out.append(sol[i])
print(bytes(out))
